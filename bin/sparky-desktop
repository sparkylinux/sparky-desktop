#!/bin/bash

# last update 2017/11/03 by pavroo

# get default's locale file
DEFLOCDIR="/usr/share/sparky/sparky-desktop"
if [ "`cat /etc/default/locale | grep es_AR`" != "" ]; then
. $DEFLOCDIR/es
elif [ "`cat /etc/default/locale | grep fr_FR`" != "" ]; then
. $DEFLOCDIR/fr
elif [ "`cat /etc/default/locale | grep it_IT`" != "" ]; then
. $DEFLOCDIR/it
elif [ "`cat /etc/default/locale | grep ja_JP`" != "" ]; then
. $DEFLOCDIR/ja
elif [ "`cat /etc/default/locale | grep pl_PL`" != "" ]; then
. $DEFLOCDIR/pl
elif [ "`cat /etc/default/locale | grep pt_BR`" != "" ]; then
. $DEFLOCDIR/pt_BR
elif [ "`cat /etc/default/locale | grep pt_PT`" != "" ]; then
. $DEFLOCDIR/pt_PT
else
. $DEFLOCDIR/en
fi

testroot="`whoami`"

if [ "$testroot" != "root" ]
then
	echo "Must be root... Exiting now..."
	exit 1
fi

DIALOG="`which yad` --width=450 --height=250 --window-icon=preferences-desktop-display --image=preferences-desktop-display"
TEXT="--text="
TITLE="--title="
ENTRY="--entry"
MENU="--list --column=$LOCAL1 --column=$LOCAL2"
OKEXIT="--button=Ok:0 --button=$LOCAL3:1"
OKBUTTON="--button=Ok:0"
USER1000=`cat /etc/passwd | grep 1000 | awk -F: '{ print $1 }'`

CHECKUSER1001=`cat /etc/passwd | grep 1001 | awk -F: '{ print $1 }'`
if [ "$CHECKUSER1001" = "" ]
then
	USER1001=""
else
	USER1001="$CHECKUSER1001"
fi

CHECKUSER1002=`cat /etc/passwd | grep 1002 | awk -F: '{ print $1 }'`
if [ "$CHECKUSER1002" = "" ]
then
	USER1002=""
else
	USER1002="$CHECKUSER1002"
fi

if [ -f /opt/sparky/sparky-xterm ]
then
. /opt/sparky/sparky-xterm
else
SPARKYXTERM="x-terminal-emulator"
fi
ARCHARM="`uname -m | grep arm`"

# check connection
PINGTEST=$(ping -c 1 debian.org | grep [0-9])

if [ "$PINGTEST" = "" ]; then
	$DIALOG $TITLE"$LOCAL6" $MSGBOX $TEXT"\n$LOCAL4"
	exit 1
fi

if [ "$1" = "pantheon" ] || [ "$1" = "trinity" ]
then
	$DIALOG $TEXT"\n$LOCAL5\n\n$LOCAL24\n\n$LOCAL11" $TITLE"$LOCAL6" $OKEXIT
else
	$DIALOG $TEXT"\n$LOCAL5\n\n$LOCAL11" $TITLE"$LOCAL6" $OKEXIT
fi

if [ "$?" != "0" ]
then
	$DIALOG $TEXT"\n$LOCAL7" $TITLE"$LOCAL6" $OKBUTTON
	exit 1
fi

# recive desktop name to be installed
case $1  in
  awesome)
	PACKAGE="awesome"
     ;;
  bspwm)
	PACKAGE="bspwm"
     ;;
  budgie)
	PACKAGE="budgie"
     ;;
  cde)
	PACKAGE="cde"
     ;;
  cinnamon)
	PACKAGE="cinnamon"
     ;;
  deepin)
	PACKAGE="deepin"
     ;;
  enlightenment)
	PACKAGE="enlightenment"
     ;;
  fluxbox)
	PACKAGE="fluxbox"
     ;;
  gnomeflashback)
	PACKAGE="gnome-flashback"
     ;;
  gnomeshell)
	PACKAGE="gnome-shell"
     ;;
  i3)
	PACKAGE="i3"
     ;;
  icewm)
	PACKAGE="icewm"
     ;;
  jwm)
	PACKAGE="jwm"
     ;;
  kde)
	PACKAGE="kde"
     ;;
  lumina)
	if [ -f /etc/apt/sources.list.d/lumina.list ] || [ -f /etc/apt/sources.list.d/lumina-testing.list ]
	then
		rm -f /etc/apt/sources.list.d/lumina*
	fi
	PACKAGE="lumina"
     ;;
  lxde)
	PACKAGE="lxde"
     ;;
  lxqt)
	PACKAGE="lxqt"
     ;;
  manokwari)
	PACKAGE="manokwari"
     ;;
  mate)
	PACKAGE="mate"
     ;;
  openbox)
	PACKAGE="openbox"
     ;;
  pantheon)
	PACKAGE="pantheon"
     ;;
  pekwm)
	PACKAGE="pekwm"
     ;;
  trinity)
	PACKAGE="trinity"
     ;;
  wmaker)
	PACKAGE="wmaker"
     ;;
  xfce)
	PACKAGE="xfce"
     ;;
esac

# install the desktop now
# checking Debian stable 8 Jessie
OLDSTABLECHECK1="`cat /etc/issue | grep 8`"
# checking Sparky 3 Annagerman based on Debian stable 8
OLDSTABLECHECK2="`cat /etc/issue | grep 3`"
# checking Debian 9/10 and Sparky 4/5
SPARKYVERCHECK5="`cat /etc/issue | grep 5`"
SPARKYVERCHECK4="`cat /etc/issue | grep 4`"
DEBIANVERCHECK10="`cat /etc/issue | grep buster`"
DEBIANVERCHECK9="`cat /etc/issue | grep stretch`"
if [ "$SPARKYVERCHECK5" != "" ] || [ "$DEBIANVERCHECK10" != "" ]
then
	TDEREPO="buster"
elif [ "$SPARKYVERCHECK4" != "" ] || [ "$DEBIANVERCHECK9" != "" ]
then
	TDEREPO="stretch"
else
	TDEREPO="sid"
fi

if [ "$1" = "bspwm" ]
then
	if [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	else
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install --no-install-recommends sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	fi

elif [ "$1" = "budgie" ]
then
	if [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	else
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install --no-install-recommends sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	fi

elif [ "$1" = "cde" ]
then
	if [ "$ARCHARM" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	else
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	fi

elif [ "$1" = "deepin" ]
then
	if [ "$ARCHARM" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	elif [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	else
		if [ -f /etc/apt/sources.list.d/sparky-dde.list ]
		then
			rm -f /etc/apt/sources.list.d/sparky-dde.list
		fi
		echo "deb https://sparkylinux.org/repo/ dde main" > /etc/apt/sources.list.d/sparky-dde.list
		echo "deb-src https://sparkylinux.org/repo/ dde main" >> /etc/apt/sources.list.d/sparky-dde.list
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install --no-install-recommends sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	fi

elif [ "$1" = "enlightenment" ]
then
	if [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	else
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install --no-install-recommends sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	fi

elif [ "$1" = "pantheon" ]
then
	if [ "$ARCHARM" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	elif [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
	then
		$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	elif [ "$SPARKYVERCHECK5" != "" ] || [ "$DEBIANVERCHECK10" != "" ]
	then
		#$DIALOG $TEXT"\n$LOCAL14" $TITLE"$LOCAL6" $OKBUTTON
		#exit 1
		if [ -f /etc/apt/sources.list.d/pantheon-debian.list ]
		then
			rm -f /etc/apt/sources.list.d/pantheon-debian.list
		fi
		echo "deb http://gandalfn.ovh/debian testing-daily main contrib" > /etc/apt/sources.list.d/pantheon-debian.list
		$SPARKYXTERM -e "wget http://gandalfn.ovh/debian/pantheon-debian.gpg.key -O- | apt-key add -"
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	elif [ "$SPARKYVERCHECK4" != "" ] || [ "$DEBIANVERCHECK9" != "" ]
	then
		if [ -f /etc/apt/sources.list.d/pantheon-debian.list ]
		then
			rm -f /etc/apt/sources.list.d/pantheon-debian.list
		fi
		echo "deb http://gandalfn.ovh/debian stretch-loki main contrib" > /etc/apt/sources.list.d/pantheon-debian.list
		$SPARKYXTERM -e "wget http://gandalfn.ovh/debian/pantheon-debian.gpg.key -O- | apt-key add -"
		$SPARKYXTERM -e "apt-get update"
		$SPARKYXTERM -e "apt-get install sparky-desktop-$PACKAGE -y"
		$SPARKYXTERM -e "apt-get install -f"
	fi

elif [ "$1" = "trinity" ]
then
	if [ -f /etc/apt/sources.list.d/trinity.list ]
	then
		rm -f /etc/apt/sources.list.d/trinity.list
	fi
	touch /etc/apt/sources.list.d/trinity.list

	if [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
	then
		$SPARKYXTERM -e "apt-key adv --keyserver keyserver.quickbuild.pearsoncomputing.net --recv-keys F5CFC95C"
		echo "deb http://mirror.ppa.trinitydesktop.org/trinity/trinity-r14.0.0/debian jessie main" >> /etc/apt/sources.list.d/trinity.list
		echo "deb-src http://mirror.ppa.trinitydesktop.org/trinity/trinity-r14.0.0/debian jessie main" >> /etc/apt/sources.list.d/trinity.list
		echo "deb http://mirror.ppa.trinitydesktop.org/trinity/trinity-builddeps-r14.0.0/debian jessie main" >> /etc/apt/sources.list.d/trinity.list
		echo "deb-src http://mirror.ppa.trinitydesktop.org/trinity/trinity-builddeps-r14.0.0/debian jessie main" >> /etc/apt/sources.list.d/trinity.list
	elif [ "$SPARKYVERCHECK5" != "" ] || [ "$DEBIANVERCHECK10" != "" ]
	then
		$SPARKYXTERM -e "apt-key adv --keyserver keys.gnupg.net --recv-key A04BE668"
		echo "deb http://mirror.xcer.cz/trinity-sb $TDEREPO deps-r14 main-r14" >> /etc/apt/sources.list.d/trinity.list
		echo "deb-src http://mirror.xcer.cz/trinity-sb $TDEREPO deps-r14 main-r14" >> /etc/apt/sources.list.d/trinity.list
	elif [ "$SPARKYVERCHECK4" != "" ] || [ "$DEBIANVERCHECK9" != "" ]
	then
		$SPARKYXTERM -e "apt-key adv --keyserver keys.gnupg.net --recv-key A04BE668"
		echo "deb http://mirror.xcer.cz/trinity-sb $TDEREPO deps-r14 main-r14" >> /etc/apt/sources.list.d/trinity.list
		echo "deb-src http://mirror.xcer.cz/trinity-sb $TDEREPO deps-r14 main-r14" >> /etc/apt/sources.list.d/trinity.list
	fi	
	$SPARKYXTERM -e "apt-get update"
	$SPARKYXTERM -e "apt-get install sparky-desktop-$PACKAGE -y"
	$SPARKYXTERM -e "apt-get install -f"
else
	$SPARKYXTERM -e "apt-get update"
	$SPARKYXTERM -e "apt-get install --no-install-recommends sparky-desktop-$PACKAGE -y"
	$SPARKYXTERM -e "apt-get install -f"
fi

# get user name to copy the desktop configs to	
if [ "$USER1001" != "" ] && [ "$USER1002" != "" ]
then
TARGETUSER=`$DIALOG $TITLE"$LOCAL8" $OKBUTTON $MENU $TEXT"\n$LOCAL9" \
$USER1000 "$USER1000" \
$USER1001 "$USER1001" \
$USER1002 "$USER1002"`

elif [ "$USER1001" != "" ] && [ "$USER1002" = "" ]
then
TARGETUSER=`$DIALOG $TITLE"$LOCAL8" $OKBUTTON $MENU $TEXT"\n$LOCAL9" \
$USER1000 "$USER1000" \
$USER1001 "$USER1001"`

else
TARGETUSER="$USER1000"
fi

TARGETUSER=`echo $TARGETUSER | cut -d "|" -f 1`

if [ ! -d /home/$TARGETUSER ]
then
	$DIALOG $TEXT"\n$LOCAL12" $TITLE"$LOCAL6" $OKBUTTON
	exit 1
fi

# replace the desktop config files
if [ "$1" = "awesome" ]
then
	if [ -f /usr/bin/awesome ] && [ -d /usr/share/sparky-desktop-data/awesome/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/awesome ]
		then
			rm -rf /home/$TARGETUSER/.config/awesome
		fi
		mkdir -p /home/$TARGETUSER/.config/awesome
		rsync -a /usr/share/sparky-desktop-data/awesome/skel/.config/awesome /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/awesome/skel/.config/nitrogen /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/awesome/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/awesome/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/awesome/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/awesome/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "bspwm" ]
then
	if [ -f /usr/bin/bspwm ] && [ -d /usr/share/sparky-desktop-data/bspwm/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/bspwm ]
		then
			rm -rf /home/$TARGETUSER/.config/bspwm
		fi
		mkdir -p /home/$TARGETUSER/.config/bspwm
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/bspwm /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/sxhkd ]
		then
			rm -rf /home/$TARGETUSER/.config/sxhkd
		fi
		mkdir -p /home/$TARGETUSER/.config/sxhkd
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/sxhkd /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/lxterminal ]
		then
			rm -rf /home/$TARGETUSER/.config/lxterminal
		fi
		mkdir -p /home/$TARGETUSER/.config/lxterminal
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/lxterminal /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/nitrogen /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/bspwm/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/bspwm/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		
		if [ -d /home/$TARGETUSER/.config/tint2 ]
		then
			rm -rf /home/$TARGETUSER/.config/tint2
		fi
		mkdir -p /home/$TARGETUSER/.config/tint2
		rsync -a /usr/share/sparky-desktop-data/bspwm/skel/.config/tint2 /home/$TARGETUSER/.config/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "budgie" ]
then
	if [ -f /usr/bin/budgie-desktop ] && [ -d /usr/share/sparky-desktop-data/budgie/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/gnome-control-center/backgrounds ]
		then
			rm -rf /home/$TARGETUSER/.config/gnome-control-center/backgrounds
		fi
		mkdir -p /home/$TARGETUSER/.config/gnome-control-center/backgrounds
		rsync -a /usr/share/sparky-desktop-data/budgie/skel/.config/gnome-control-center/backgrounds /home/$TARGETUSER/.config/gnome-control-center/
		
		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/budgie/skel/.config/dconf /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/budgie/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/budgie/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/budgie/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "cde" ]
then
	if [ -d /usr/dt/bin ]; then
		echo "installation cde desktop ok, no extra files to be installed"
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "cinnamon" ]
then
	if [ -f /usr/bin/cinnamon ] && [ -d /usr/share/sparky-desktop-data/cinnamon/skel ]
	then
		if [ -d /home/$TARGETUSER/.cinnamon ]
		then
			rm -rf /home/$TARGETUSER/.cinnamon
		fi
		mkdir -p /home/$TARGETUSER/.cinnamon
		rsync -a /usr/share/sparky-desktop-data/cinnamon/skel/.cinnamon /home/$TARGETUSER/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.cinnamon

		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/cinnamon/skel/.config/dconf /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/cinnamon/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/cinnamon/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/cinnamon/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/cinnamon/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		
		if [ -f /home/$TARGETUSER/.local/share/applications/synaptic.desktop ]
		then
			rm -f /home/$TARGETUSER/.local/share/applications/synaptic.desktop
		fi
		if [ ! -d /home/$TARGETUSER/.local/share/applications ]
		then
			mkdir -p /home/$TARGETUSER/.local/share/applications
		fi
		cp /usr/share/sparky-desktop-data/cinnamon/skel/.local/share/applications/synaptic.desktop /home/$TARGETUSER/.local/share/applications/synaptic.desktop
		
		if [ -f /home/$TARGETUSER/.local/share/applications/gufw.desktop ]
		then
			rm -f /home/$TARGETUSER/.local/share/applications/gufw.desktop
		fi
		cp /usr/share/sparky-desktop-data/cinnamon/skel/.local/share/applications/gufw.desktop /home/$TARGETUSER/.local/share/applications/gufw.desktop
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.local
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "deepin" ]
then
	if [ -f /usr/bin/startdde ] && [ -d /usr/share/sparky-desktop-data/deepin/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/deepin/skel/.config/dconf /home/$TARGETUSER/.config/

		#CHECKDM=`cat /etc/X11/default-display-manager | grep lightdm`
		#if [ "$CHECKDM" != "" ]
		#then
		#	sed -i -e 's/lightdm/slim/g' /etc/X11/default-display-manager
		#	sed -i -e 's/sbin/bin/g' /etc/X11/default-display-manager
		#	if [ -f /lib/systemd/system/slim.service ] && [ -f /etc/systemd/system/display-manager.service ]
		#	then
		#		rm -f /etc/systemd/system/display-manager.service
		#		ln -s /lib/systemd/system/slim.service /etc/systemd/system/display-manager.service
		#	fi
		#fi
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/deepin/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/deepin/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/deepin/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		
		if [ -f /home/$TARGETUSER/.config/nautilus/desktop-metadata ]
		then
			rm -f /home/$TARGETUSER/.config/nautilus/desktop-metadata
		fi
		if [ ! -d /home/$TARGETUSER/.config/nautilus ]
		then
			mkdir -p /home/$TARGETUSER/.config/nautilus
		fi
		cp /usr/share/sparky-desktop-data/deepin/skel/.config/nautilus/desktop-metadata /home/$TARGETUSER/.config/nautilus/desktop-metadata

		if [ -f /home/$TARGETUSER/.local/share/applications/synaptic.desktop ]
		then
			rm -f /home/$TARGETUSER/.local/share/applications/synaptic.desktop
		fi
		if [ ! -d /home/$TARGETUSER/.local/share/applications ]
		then
			mkdir -p /home/$TARGETUSER/.local/share/applications
		fi
		cp /usr/share/sparky-desktop-data/deepin/skel/.local/share/applications/synaptic.desktop /home/$TARGETUSER/.local/share/applications/synaptic.desktop

		if [ -f /home/$TARGETUSER/.local/share/applications/gufw.desktop ]
		then
			rm -f /home/$TARGETUSER/.local/share/applications/gufw.desktop
		fi
		cp /usr/share/sparky-desktop-data/deepin/skel/.local/share/applications/gufw.desktop /home/$TARGETUSER/.local/share/applications/gufw.desktop
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.local
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "enlightenment" ]
then
	if [ -f /usr/bin/enlightenment ] && [ -d /usr/share/sparky-desktop-data/enlightenment/skel ]
	then
		if [ -d /home/$TARGETUSER/.e ]
		then
			rm -rf /home/$TARGETUSER/.e
		fi
		mkdir -p /home/$TARGETUSER/.e
		rsync -a /usr/share/sparky-desktop-data/enlightenment/skel/.e /home/$TARGETUSER/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.e

		rsync -a /usr/share/sparky-desktop-data/enlightenment/applications /usr/share/

		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/enlightenment/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/enlightenment/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/enlightenment/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/enlightenment/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "fluxbox" ]
then
	if [ -f /usr/bin/startfluxbox ] && [ -d /usr/share/sparky-desktop-data/fluxbox/skel ] && [ -f /opt/sparky/sparky-fluxbox ]
	then
		if [ -d /home/$TARGETUSER/.fluxbox ]
		then
			rm -rf /home/$TARGETUSER/.fluxbox
		fi
		mkdir -p /home/$TARGETUSER/.fluxbox
		rsync -a /usr/share/sparky-desktop-data/fluxbox/skel/.fluxbox /home/$TARGETUSER/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.fluxbox

		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/fluxbox/skel/.config/nitrogen /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/fluxbox/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/fluxbox/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/fluxbox/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/fluxbox/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "gnomeflashback" ]
then
	if [ -f /usr/bin/gnome-flashback ] && [ -d /usr/share/sparky-desktop-data/gnome-fl/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/gnome-control-center/backgrounds ]
		then
			rm -rf /home/$TARGETUSER/.config/gnome-control-center/backgrounds
		fi
		mkdir -p /home/$TARGETUSER/.config/gnome-control-center/backgrounds
		rsync -a /usr/share/sparky-desktop-data/gnome-fl/skel/.config/gnome-control-center/backgrounds /home/$TARGETUSER/.config/gnome-control-center/
		
		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/gnome-fl/skel/.config/dconf /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/gnome-fl/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/gnome-fl/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/gnome-fl/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/gnome-fl/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "gnomeshell" ]
then
	if [ -f /TARGET/usr/share/xsessions/gnome.desktop ] && [ -d /usr/share/sparky-desktop-data/gnome-sh/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/gnome-control-center/backgrounds ]
		then
			rm -rf /home/$TARGETUSER/.config/gnome-control-center/backgrounds
		fi
		mkdir -p /home/$TARGETUSER/.config/gnome-control-center/backgrounds
		rsync -a /usr/share/sparky-desktop-data/gnome-sh/skel/.config/gnome-control-center/backgrounds /home/$TARGETUSER/.config/gnome-control-center/

		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/gnome-sh/skel/.config/dconf /home/$TARGETUSER/.config/

		CHECKDM=`cat /etc/X11/default-display-manager | grep gdm`
		if [ "$CHECKDM" != "" ]
		then
			sed -i -e 's/gdm3/lightdm/g' /etc/X11/default-display-manager
			if [ -f /usr/lib/systemd/system/lightdm.service ] && [ -f /etc/systemd/system/display-manager.service ]
			then
				rm -f /etc/systemd/system/display-manager.service
				ln -s /lib/systemd/system/lightdm.service /etc/systemd/system/display-manager.service
			fi
		fi

		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/gnome-sh/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/gnome-sh/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/gnome-sh/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/gnome-sh/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "i3" ]
then
	if [ -f /usr/bin/i3 ] && [ -d /usr/share/sparky-desktop-data/i3/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/i3 ]
		then
			rm -rf /home/$TARGETUSER/.config/i3
		fi
		mkdir -p /home/$TARGETUSER/.config/i3
		rsync -a /usr/share/sparky-desktop-data/i3/skel/.config/i3 /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/lxterminal ]
		then
			rm -rf /home/$TARGETUSER/.config/lxterminal
		fi
		mkdir -p /home/$TARGETUSER/.config/lxterminal
		rsync -a /usr/share/sparky-desktop-data/i3/skel/.config/lxterminal /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/i3/skel/.config/nitrogen /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/i3/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/i3/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/i3/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/i3/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "icewm" ]
then
	if [ -f /usr/bin/icewm ] && [ -d /usr/share/sparky-desktop-data/icewm/skel ]
	then
		if [ -d /home/$TARGETUSER/.icewm ]
		then
			rm -rf /home/$TARGETUSER/.icewm
		fi
		mkdir -p /home/$TARGETUSER/.icewm
		rsync -a /usr/share/sparky-desktop-data/icewm/skel/.icewm /home/$TARGETUSER/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.icewm

		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/icewm/skel/.config/nitrogen /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/icewm/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/icewm/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/icewm/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/icewm/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "jwm" ]
then
	if [ -f /usr/bin/jwm ] && [ -d /usr/share/sparky-desktop-data/jwm/skel ]
	then
		if [ -f /home/$TARGETUSER/.jwmrc ]
		then
			rm -f /home/$TARGETUSER/.jwmrc
		fi
		cp /usr/share/sparky-desktop-data/jwm/skel/.jwmrc /home/$TARGETUSER/.jwmrc
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.jwmrc

		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/jwm/skel/.config/nitrogen /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/jwm/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/jwm/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/jwm/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/jwm/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "kde" ]
then
	if [ -f /usr/bin/startkde ] && [ -d /usr/share/sparky-desktop-data/kde/skel ]
	then
		if [ -f /etc/sddm.conf ]
		then
			rm -f /etc/sddm.conf
		fi
		cp /usr/share/sparky-desktop-data/kde/etc/sddm.conf /etc/sddm.conf

		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/kde/skel/.config/dconf /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.config/gtkrc ]
		then
			rm -f /home/$TARGETUSER/.config/gtkrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/gtkrc /home/$TARGETUSER/.config/gtkrc

		if [ -f /home/$TARGETUSER/.config/gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.config/gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/gtkrc-2.0 /home/$TARGETUSER/.config/gtkrc-2.0

		if [ -f /home/$TARGETUSER/.config/kcminputrc ]
		then
			rm -f /home/$TARGETUSER/.config/kcminputrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/kcminputrc /home/$TARGETUSER/.config/kcminputrc

		if [ -f /home/$TARGETUSER/.config/kdeglobals ]
		then
			rm -f /home/$TARGETUSER/.config/kdeglobals
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/kdeglobals /home/$TARGETUSER/.config/kdeglobals

		if [ -f /home/$TARGETUSER/.config/kickoffrc ]
		then
			rm -f /home/$TARGETUSER/.config/kickoffrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/kickoffrc /home/$TARGETUSER/.config/kickoffrc

		if [ -f /home/$TARGETUSER/.config/kscreenlockerrc ]
		then
			rm -f /home/$TARGETUSER/.config/kscreenlockerrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/kscreenlockerrc /home/$TARGETUSER/.config/kscreenlockerrc

		if [ -f /home/$TARGETUSER/.config/ksplashrc ]
		then
			rm -f /home/$TARGETUSER/.config/ksplashrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/ksplashrc /home/$TARGETUSER/.config/ksplashrc

		if [ -f /home/$TARGETUSER/.config/kwinrc ]
		then
			rm -f /home/$TARGETUSER/.config/kwinrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/kwinrc /home/$TARGETUSER/.config/kwinrc

		if [ -f /home/$TARGETUSER/.config/plasma-org.kde.plasma.desktop-appletsrc ]
		then
			rm -f /home/$TARGETUSER/.config/plasma-org.kde.plasma.desktop-appletsrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/plasma-org.kde.plasma.desktop-appletsrc /home/$TARGETUSER/.config/plasma-org.kde.plasma.desktop-appletsrc

		if [ -f /home/$TARGETUSER/.config/plasmarc ]
		then
			rm -f /home/$TARGETUSER/.config/plasmarc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/plasmarc /home/$TARGETUSER/.config/plasmarc

		if [ -f /home/$TARGETUSER/.config/plasmashellrc ]
		then
			rm -f /home/$TARGETUSER/.config/plasmashellrc
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/plasmashellrc /home/$TARGETUSER/.config/plasmashellrc

		if [ -f /home/$TARGETUSER/.config/QtProject.conf ]
		then
			rm -f /home/$TARGETUSER/.config/QtProject.conf
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/QtProject.conf /home/$TARGETUSER/.config/QtProject.conf

		if [ -f /home/$TARGETUSER/.config/startupconfig ]
		then
			rm -f /home/$TARGETUSER/.config/startupconfig
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/startupconfig /home/$TARGETUSER/.config/startupconfig

		if [ -f /home/$TARGETUSER/.config/startupconfigfiles ]
		then
			rm -r /home/$TARGETUSER/.config/startupconfigfiles
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/startupconfigfiles /home/$TARGETUSER/.config/startupconfigfiles

		if [ -f /home/$TARGETUSER/.config/startupconfigkeys ]
		then
			rm -f /home/$TARGETUSER/.config/startupconfigkeys
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/startupconfigkeys /home/$TARGETUSER/.config/startupconfigkeys

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/kde/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf

		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/kde/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1		
	fi

elif [ "$1" = "lumina" ]
then
	if [ -f /usr/bin/lumina-desktop ] && [ -d /usr/share/sparky-desktop-data/lumina/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/lumina-desktop ]
		then
			rm -rf /home/$TARGETUSER/.config/lumina-desktop
		fi
		mkdir -p /home/$TARGETUSER/.config/lumina-desktop
		rsync -a /usr/share/sparky-desktop-data/lumina/skel/.config/lumina-desktop /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/fluxbox/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/fluxbox/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/fluxbox/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/fluxbox/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		
		if [ -f /home/$TARGETUSER/.config/autostart/polkit-gnome-authentication-agent-1.desktop ]
		then
			rm -f /home/$TARGETUSER/.config/autostart/polkit-gnome-authentication-agent-1.desktop
		fi
		if [ -f /home/$TARGETUSER/.config/autostart/lxpolkit.desktop ]
		then
			rm -f /home/$TARGETUSER/.config/autostart/lxpolkit.desktop
		fi
		if [ ! -d /home/$TARGETUSER/.config/autostart ]
		then
			mkdir -p /home/$TARGETUSER/.config/autostart
		fi		
		cp /usr/share/sparky-desktop-data/lumina/skel/.config/autostart/lxpolkit.desktop /home/$TARGETUSER/.config/autostart/lxpolkit.desktop
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "lxde" ]
then
	if [ -f /usr/bin/startlxde ] && [ -d /usr/share/sparky-desktop-data/lxde/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/lxde/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/lxde/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/lxpanel ]
		then
			rm -rf /home/$TARGETUSER/.config/lxpanel
		fi
		mkdir -p /home/$TARGETUSER/.config/lxpanel
		rsync -a /usr/share/sparky-desktop-data/lxde/skel/.config/lxpanel /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/lxsession ]
		then
			rm -rf /home/$TARGETUSER/.config/lxsession
		fi
		mkdir -p /home/$TARGETUSER/.config/lxsession
		rsync -a /usr/share/sparky-desktop-data/lxde/skel/.config/lxsession /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/openbox/lxde-rc.xml ]
		then
			rm -f /home/$TARGETUSER/.config/openbox/lxde-rc.xml
		fi
		if [ ! -d /home/$TARGETUSER/.config/openbox ]
		then
			mkdir -p /home/$TARGETUSER/.config/openbox
		fi
		cp /usr/share/sparky-desktop-data/lxde/skel/.config/openbox/lxde-rc.xml /home/$TARGETUSER/.config/openbox/lxde-rc.xml
		
		if [ -d /home/$TARGETUSER/.config/pcmanfm ]
		then
			rm -rf /home/$TARGETUSER/.config/pcmanfm
		fi
		mkdir -p /home/$TARGETUSER/.config/pcmanfm
		rsync -a /usr/share/sparky-desktop-data/lxde/skel/.config/pcmanfm /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/lxde/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/lxde/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config

		if [ -f /home/$TARGETUSER/.config/menus/lxde-applications.menu ]
		then
			rm -f /home/$TARGETUSER/.config/menus/lxde-applications.menu
		fi
		if [ ! -d /home/$TARGETUSER/.config/menus ]
		then
			mkdir -p /home/$TARGETUSER/.config/menus
		fi
		cp /usr/share/sparky-desktop-data/lxde/skel/.config/menus/lxde-applications.menu /home/$TARGETUSER/.config/menus/
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config/menus
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "lxqt" ]
then
	if [ -f /usr/bin/startlxqt ] && [ -d /usr/share/sparky-desktop-data/lxqt/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/lxqt/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/lxqt/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/lxqt ]
		then
			rm -rf /home/$TARGETUSER/.config/lxqt
		fi
		mkdir -p /home/$TARGETUSER/.config/lxqt
		rsync -a /usr/share/sparky-desktop-data/lxqt/skel/.config/lxqt /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/openbox/rc.xml ]
		then
			rm -f /home/$TARGETUSER/.config/openbox/rc.xml
		fi
		if [ ! -d /home/$TARGETUSER/.config/openbox ]
		then
			mkdir -p /home/$TARGETUSER/.config/openbox
		fi
		cp /usr/share/sparky-desktop-data/lxqt/skel/.config/openbox/rc.xml /home/$TARGETUSER/.config/openbox/rc.xml
		
		if [ -d /home/$TARGETUSER/.config/pcmanfm-qt ]
		then
			rm -rf /home/$TARGETUSER/.config/pcmanfm-qt
		fi
		mkdir -p /home/$TARGETUSER/.config/pcmanfm-qt
		rsync -a /usr/share/sparky-desktop-data/lxqt/skel/.config/pcmanfm-qt /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/lxqt/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/lxqt/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "mate" ]
then
	if [ -f /usr/bin/mate-session ] && [ -d /usr/share/sparky-desktop-data/mate/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/
		rsync -a /usr/share/sparky-desktop-data/mate/skel/.config/dconf /home/$TARGETUSER/.config/

		if [ -d /home/$TARGETUSER/.config/mate ]
		then
			rm -rf /home/$TARGETUSER/.config/mate
		fi
		mkdir -p /home/$TARGETUSER/.config/mate
		rsync -a /usr/share/sparky-desktop-data/mate/skel/.config/mate /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/mate-menu ]
		then
			rm -rf /home/$TARGETUSER/.config/mate-menu
		fi
		mkdir -p /home/$TARGETUSER/.config/mate-menu
		rsync -a /usr/share/sparky-desktop-data/mate/skel/.config/mate-menu /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/mate/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/mate/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/mate/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/mate/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "openbox" ]
then
	if [ -f /usr/bin/obmenu-generator ] && [ -d /usr/share/sparky-desktop-data/openbox/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/lxsession ]
		then
			rm -rf /home/$TARGETUSER/.config/lxsession
		fi
		mkdir -p /home/$TARGETUSER/.config/lxsession
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/lxsession /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/nitrogen /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/obmenu-generator ]
		then
			rm -rf /home/$TARGETUSER/.config/obmenu-generator
		fi
		mkdir -p /home/$TARGETUSER/.config/obmenu-generator
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/obmenu-generator /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/openbox ]
		then
			rm -rf /home/$TARGETUSER/.config/openbox
		fi
		mkdir -p /home/$TARGETUSER/.config/openbox
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/openbox /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/pcmanfm ]
		then
			rm -rf /home/$TARGETUSER/.config/pcmanfm
		fi
		mkdir -p /home/$TARGETUSER/.config/pcmanfm
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/pcmanfm /home/$TARGETUSER/.config/
		
		if [ -f /usr/bin/tint2 ] && [ -d /home/$TARGETUSER/.config/tint2 ]
		then
			rm -rf /home/$TARGETUSER/.config/tint2
		fi
		mkdir -p /home/$TARGETUSER/.config/tint2
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/tint2 /home/$TARGETUSER/.config/

		if [ -f /usr/bin/fbpanel ] && [ -d /home/$TARGETUSER/.config/fbpanel ]
		then
			rm -rf /home/$TARGETUSER/.config/fbpanel
		fi
		mkdir -p /home/$TARGETUSER/.config/fbpanel
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/fbpanel /home/$TARGETUSER/.config/

		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/openbox/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/openbox/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/openbox/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config

		if [ -f /home/$TARGETUSER/.config/menus/lxde-applications.menu ]
		then
			rm -f /home/$TARGETUSER/.config/menus/lxde-applications.menu
		fi
		if [ ! -d /home/$TARGETUSER/.config/menus ]
		then
			mkdir -p /home/$TARGETUSER/.config/menus
		fi
		cp /usr/share/sparky-desktop-data/lxde/skel/.config/menus/lxde-applications.menu /home/$TARGETUSER/.config/menus/
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config/menus
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

#elif [ "$1" = "pantheon" ]
#then
#	$DIALOG $TEXT"\nThe Pantheon desktop is temporary not available." $TITLE"$LOCAL6" $OKBUTTON
#	exit 1

elif [ "$1" = "pantheon" ]
then
	if [ -f /usr/bin/pantheon-session ] && [ -d /usr/share/sparky-desktop-data/pantheon/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/marlin ]
		then
			rm -rf /home/$TARGETUSER/.config/marlin
		fi
		mkdir -p /home/$TARGETUSER/.config/marlin
		rsync -a /usr/share/sparky-desktop-data/pantheon/skel/.config/marlin /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/plank ]
		then
			rm -rf /home/$TARGETUSER/.config/plank
		fi
		mkdir -p /home/$TARGETUSER/.config/plank
		rsync -a /usr/share/sparky-desktop-data/pantheon/skel/.config/plank /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/dconf ]
		then
			rm -rf /home/$TARGETUSER/.config/dconf
		fi
		mkdir -p /home/$TARGETUSER/.config/dconf
		rsync -a /usr/share/sparky-desktop-data/pantheon/skel/.config/dconf /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/pantheon/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/pantheon/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/pantheon/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/pantheon/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
		
		CHECKDM=`cat /etc/X11/default-display-manager | grep lightdm`
		if [ "$CHECKDM" != "" ]
		then
			sed -i -e 's/lightdm/slim/g' /etc/X11/default-display-manager
			sed -i -e 's/sbin/bin/g' /etc/X11/default-display-manager
			if [ -f /lib/systemd/system/slim.service ] && [ -f /etc/systemd/system/display-manager.service ]
			then
				rm -f /etc/systemd/system/display-manager.service
				ln -s /lib/systemd/system/slim.service /etc/systemd/system/display-manager.service
			fi
		fi
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "pekwm" ]
then
	if [ -f /usr/bin/pekwm ] && [ -d /usr/share/sparky-desktop-data/pekwm/skel ]
	then
		if [ -d /home/$TARGETUSER/.pekwm ]
		then
			rm -rf /home/$TARGETUSER/.pekwm
		fi
		mkdir -p /home/$TARGETUSER/.pekwm
		rsync -a /usr/share/sparky-desktop-data/pekwm/skel/.pekwm /home/$TARGETUSER/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.pekwm

		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/pekwm/skel/.config/nitrogen /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/pekwm/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/pekwm/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/pekwm/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/pekwm/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		
		if [ -d /home/$TARGETUSER/.config/fbpanel ]
		then
			rm -rf /home/$TARGETUSER/.config/fbpanel
		fi
		mkdir -p /home/$TARGETUSER/.config/fbpanel
		rsync -a /usr/share/sparky-desktop-data/pekwm/skel/.config/fbpanel /home/$TARGETUSER/.config/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "trinity" ]
then
	if [ -d /usr/share/doc/tde-core-trinity ] && [ -d /usr/share/sparky-desktop-data/trinity/skel ]
	then
		if [ ! -f /home/$TARGETUSER/.trinity/Autostart/*polkit*.desktop ]
		then
			if [ ! -d /home/$TARGETUSER/.trinity/Autostart ]
			then
				mkdir -p /home/$TARGETUSER/.trinity/Autostart
			fi
			#if [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
			#then
				cp /usr/share/sparky-desktop-data/trinity/skel/.trinity/Autostart/sparky-polkit.desktop /home/$TARGETUSER/.trinity/Autostart/sparky-polkit.desktop
			#else
			#	cp /usr/share/sparky-desktop-data/trinity/skel/.trinity/Autostart/polkit-gnome-authentication-agent-1.desktop /home/$TARGETUSER/.trinity/Autostart/polkit-gnome-authentication-agent-1.desktop
			#fi
		else
			rm -f /home/$TARGETUSER/.trinity/Autostart/*polkit*.desktop
			#if [ "$OLDSTABLECHECK1" != "" ] || [ "$OLDSTABLECHECK2" != "" ]
			#then
				cp /usr/share/sparky-desktop-data/trinity/skel/.trinity/Autostart/sparky-polkit.desktop /home/$TARGETUSER/.trinity/Autostart/sparky-polkit.desktop
			#else
			#	cp /usr/share/sparky-desktop-data/trinity/skel/.trinity/Autostart/polkit-gnome-authentication-agent-1.desktop /home/$TARGETUSER/.trinity/Autostart/polkit-gnome-authentication-agent-1.desktop
			#fi
		fi
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.trinity

		CHECKDM=`cat /etc/X11/default-display-manager | grep tdm`
		if [ "$CHECKDM" != "" ]
		then
			rm -f /etc/X11/default-display-manager
			echo "/usr/sbin/lightdm" > /etc/X11/default-display-manager
			if [ -f /usr/lib/systemd/system/lightdm.service ] && [ -f /etc/systemd/system/display-manager.service ]
			then
				rm -f /etc/systemd/system/display-manager.service
				ln -s /lib/systemd/system/lightdm.service /etc/systemd/system/display-manager.service
			fi
		fi
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1		
	fi

elif [ "$1" = "wmaker" ]
then
	if [ -f /usr/bin/wmaker ] && [ -d /usr/share/sparky-desktop-data/wmaker/skel ]
	then
		if [ -d /home/$TARGETUSER/GNUstep ]
		then
			rm -rf /home/$TARGETUSER/GNUstep
		fi
		mkdir -p /home/$TARGETUSER/GNUstep
		rsync -a /usr/share/sparky-desktop-data/wmaker/skel/GNUstep /home/$TARGETUSER/
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/GNUstep

		if [ -d /home/$TARGETUSER/.config/nitrogen ]
		then
			rm -rf /home/$TARGETUSER/.config/nitrogen
		fi
		mkdir -p /home/$TARGETUSER/.config/nitrogen
		rsync -a /usr/share/sparky-desktop-data/wmaker/skel/.config/nitrogen /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/wmaker/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/wmaker/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/wmaker/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/wmaker/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

elif [ "$1" = "xfce" ]
then
	if [ -f /usr/bin/startxfce4 ] && [ -d /usr/share/sparky-desktop-data/xfce/skel ]
	then
		if [ -d /home/$TARGETUSER/.config/xfce4 ]
		then
			rm -rf /home/$TARGETUSER/.config/xfce4
		fi
		mkdir -p /home/$TARGETUSER/.config/xfce4
		rsync -a /usr/share/sparky-desktop-data/xfce/skel/.config/xfce4 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.gtkrc-2.0 ]
		then
			rm -f /home/$TARGETUSER/.gtkrc-2.0
		fi
		cp /usr/share/sparky-desktop-data/xfce/skel/.gtkrc-2.0 /home/$TARGETUSER/.gtkrc-2.0
		chown $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.gtkrc-2.0

		if [ -d /home/$TARGETUSER/.config/gtk-2.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-2.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-2.0
		rsync -a /usr/share/sparky-desktop-data/xfce/skel/.config/gtk-2.0 /home/$TARGETUSER/.config/
		
		if [ -d /home/$TARGETUSER/.config/gtk-3.0 ]
		then
			rm -rf /home/$TARGETUSER/.config/gtk-3.0
		fi
		mkdir -p /home/$TARGETUSER/.config/gtk-3.0
		rsync -a /usr/share/sparky-desktop-data/xfce/skel/.config/gtk-3.0 /home/$TARGETUSER/.config/
		
		if [ -f /home/$TARGETUSER/.config/Trolltech.conf ]
		then
			rm -f /home/$TARGETUSER/.config/Trolltech.conf
		fi
		cp /usr/share/sparky-desktop-data/xfce/skel/.config/Trolltech.conf /home/$TARGETUSER/.config/Trolltech.conf
		chown -R $TARGETUSER:$TARGETUSER /home/$TARGETUSER/.config
	else
		$DIALOG $TEXT"\n$LOCAL13" $TITLE"$LOCAL6" $OKBUTTON
		exit 1
	fi

fi

if [ -f /home/$TARGETUSER/.xsession ]
then
	rm -f /home/$TARGETUSER/.xsession
fi

$DIALOG $TEXT"\n$LOCAL10" $TITLE"$LOCAL6" $OKBUTTON

exit 0
